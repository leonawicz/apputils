<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Update leaflet map in map set context — update_mapset â€¢ apputils</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  <link href="../extra.css" rel="stylesheet">
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">apputils</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/apputils.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-globe fa-lg"></span>
     
    SNAPverse
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://leonawicz.github.io/sv">Home of the verse</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Sector packages</li>
    <li>
      <a href="http://leonawicz.github.io/snapverse">snapverse</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snaplite">snaplite</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snapdata">snapdata</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Functions packages</li>
    <li>
      <a href="http://leonawicz.github.io/snapfuns">snapfuns</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snapprep">snapprep</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/alfresco">alfresco</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Data packages</li>
    <li>
      <a href="http://leonawicz.github.io/snapclim">snapclim</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snapfire">snapfire</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snappoly">snappoly</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snapmaps">snapmaps</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snapdist">snapdist</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Apps packages</li>
    <li>
      <a href="http://leonawicz.github.io/snapapps">snapapps</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Satellite packages</li>
    <li>
      <a href="http://leonawicz.github.io/rvtable">rvtable</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/apputils">apputils</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/maputils">maputils</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snaputils">snaputils</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snapmeta">snapmeta</a>
    </li>
    <li>
      <a href="http://leonawicz.github.io/snapsite">snapsite</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/leonawicz/apputils">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Update leaflet map in map set context</h1>
    </div>

    
    <p>Update an existing leaflet map in a context of multiple map sets and corresponding shapefiles.</p>
    

    <pre class="usage"><span class='fu'>update_mapset</span>(<span class='no'>trigger</span>, <span class='no'>shp</span>, <span class='no'>mapset</span>, <span class='no'>ids</span>, <span class='no'>selected_regions</span>, <span class='no'>all_regions</span>,
  <span class='no'>all_locs</span>, <span class='kw'>all_locs_shapefile</span> <span class='kw'>=</span> <span class='no'>all_locs</span>, <span class='kw'>default</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='no'>click_id</span>, <span class='no'>session</span>,
  <span class='kw'>map</span> <span class='kw'>=</span> <span class='st'>"Map"</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='st'>"#3C8DBC"</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>color</span>, <span class='kw'>color_opacity</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>fill_opacity</span> <span class='kw'>=</span> <span class='fl'>0.4</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>trigger</th>
      <td><p>character, <code>"selectInput"</code> or <code>"mapclick"</code>. Must used both in an app. See details.</p></td>
    </tr>
    <tr>
      <th>shp</th>
      <td><p>a shapefile pertaining to a single <code>mapset</code>. See <code>build_mapset</code>.</p></td>
    </tr>
    <tr>
      <th>mapset</th>
      <td><p>character, name of a mapset in <code>mapsets</code>. See <code>build_mapset</code>.</p></td>
    </tr>
    <tr>
      <th>ids</th>
      <td><p>literal names of regions in <code>shp</code> (may not match <code>regions</code> elements).</p></td>
    </tr>
    <tr>
      <th>selected_regions</th>
      <td><p>a subset of <code>all_regions</code>.</p></td>
    </tr>
    <tr>
      <th>all_regions</th>
      <td><p>a named vector of region IDs pertaining to regions in <code>shp</code>.</p></td>
    </tr>
    <tr>
      <th>all_locs</th>
      <td><p>a named list (names match <code>mapsets</code>)
where each list element is a vector of regions.</p></td>
    </tr>
    <tr>
      <th>all_locs_shapefile</th>
      <td><p>a named list (names match <code>mapsets</code>)
where each list element is a vector of regions specified to match the region IDs in <code>shp</code>.</p></td>
    </tr>
    <tr>
      <th>default</th>
      <td><p>name of a default map set, if used. Otherwise defaults to <code>default=""</code>.</p></td>
    </tr>
    <tr>
      <th>click_id</th>
      <td><p>character, the leaflet map click id.</p></td>
    </tr>
    <tr>
      <th>session</th>
      <td><p>the app session variable.</p></td>
    </tr>
    <tr>
      <th>map</th>
      <td><p>character, name of leaflet map object.</p></td>
    </tr>
    <tr>
      <th>color</th>
      <td><p>border color for selected polygons.</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>fill color for selected polygons.</p></td>
    </tr>
    <tr>
      <th>color_opacity</th>
      <td><p>numeric, border color opacity.</p></td>
    </tr>
    <tr>
      <th>fill_opacity</th>
      <td><p>numeric, fill color opacity.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>side effects only, called from within Shiny observers to update <code>selectInput</code> and leaflet output map.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function updates a leaflet map made using <code>build_mapset</code>. It is called from within Shiny observers. See examples.
The function is used twice in two contexts in an app in conjunction with a single original <code>build_mapset</code> call for a single
leaflet output instance.
Specifically, one call is within an observer that reacts to map polygon mouse clicks
and the other call is within an observer that reacts to changes to the <code><a href='http://www.rdocumentation.org/packages/shiny/topics/selectInput'>shiny::selectInput</a></code>
that is synced to the leaflet map polygon selections.</p>
<p>The function takes a number of the same arguments passed to <code>build_mapset</code>.
Compared to <code>build_mapset</code>, color, fill and opacity is simplified to single values each
since this function only deals with the adding of selected polygons
to the map, not the adding of unselected polygons or polygon mouse hover options.</p>
<p>Note that the <code>selectInput</code> observer context (<code>trigger="selectInput"</code>) requires all arguments to be supplied except for
<code>click_id</code> and session, which are needed only for <code>trigger="mapclick"</code>.
In the case of the latter, the only arguments needed (or used) are
<code>trigger</code>, <code>click_id</code>, <code>session</code> and <code>selected_regions</code>. All other arguments may be left out.
Map clicks are observed strictly to update the synchronized <code>selectInput</code>, not to remove or add polygons directly.
In turn, changes to the <code>selectInput</code>, whether by the user directly, or by updating on map click observation,
are responsible for updating map polygon layers.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># Observe polygon selectInput.</span>
<span class='co'># Add or remove selected polygons leaflet map polygons.</span>
<span class='fu'>observeEvent</span>(<span class='no'>input</span>$<span class='no'>regions</span>, {
  <span class='fu'>update_mapset</span>(<span class='st'>"selectInput"</span>, <span class='no'>shp</span>, <span class='no'>mapset</span>, <span class='no'>ids</span>,
    <span class='no'>input</span>$<span class='no'>regions</span>, <span class='no'>all_regions</span>, <span class='no'>all_locs</span>)
}, <span class='kw'>ignoreNULL</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='co'># Observe leaflet map shape click.</span>
<span class='co'># Update region selectInput.</span>
<span class='fu'>observeEvent</span>(<span class='no'>input</span>$<span class='no'>Map_shape_click</span>, {
  <span class='fu'>update_mapset</span>(<span class='st'>"mapclick"</span>, <span class='kw'>selected_regions</span><span class='kw'>=</span><span class='no'>input</span>$<span class='no'>regions</span>,
                <span class='kw'>click_id</span><span class='kw'>=</span><span class='no'>input</span>$<span class='no'>Map_shape_click</span>$<span class='no'>id</span>, <span class='kw'>session</span><span class='kw'>=</span><span class='no'>session</span>)
})
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matthew Leonawicz, Scenarios Network for Alaska and Arctic Planning.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
